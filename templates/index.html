<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop Online - Thời trang chất lượng</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f9f9f9;
        }

        header {
            background-color: #fff;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #4a6cf7;
        }

        nav ul {
            display: flex;
            list-style: none;
        }

        nav ul li {
            margin-left: 20px;
        }

        nav ul li a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s;
        }

        nav ul li a:hover {
            color: #4a6cf7;
        }

        .banner {
            background-image: linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url('https://images.unsplash.com/photo-1512436991641-6745cdb1723f?auto=format&fit=crop&w=1200&q=80');
            background-size: cover;
            background-position: center;
            height: 400px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
        }

        .banner-content h1 {
            font-size: 42px;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .btn {
            display: inline-block;
            padding: 12px 30px;
            background-color: #4a6cf7;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        .btn:hover {
            background-color: #3a5bd9;
        }

        main {
            max-width: 1200px;
            margin: 40px auto;
            padding: 0 20px;
        }

        .section-title {
            text-align: center;
            margin-bottom: 30px;
            color: #333;
        }

        .products {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .product-card {
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }

        .product-card:hover {
            transform: translateY(-5px);
        }

        .product-image {
            width: 100%;
            height: 200px;
            overflow: hidden;
        }

        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .product-info {
            padding: 15px;
        }

        .product-title {
            font-size: 18px;
            margin-bottom: 10px;
            color: #333;
        }

        .product-price {
            font-size: 20px;
            font-weight: bold;
            color: #4a6cf7;
            margin-bottom: 15px;
        }

        .add-to-cart {
            width: 100%;
            padding: 10px;
            background-color: #4a6cf7;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        .add-to-cart:hover {
            background-color: #3a5bd9;
        }

        footer {
            background-color: #333;
            color: white;
            padding: 40px 0 20px;
        }

        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }

        .footer-section h3 {
            margin-bottom: 20px;
            font-size: 20px;
        }

        .footer-section p {
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .social-links {
            display: flex;
            gap: 15px;
        }

        .social-links a {
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .copyright {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        @media (max-width: 768px) {
            .banner {
                height: 300px;
            }
            
            .banner-content h1 {
                font-size: 32px;
            }
        }
        .review-form-container {
            background-color: #f9f9f9;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .submit-review-btn {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        .submit-review-btn:hover {
            background-color: #45a049;
        }
        #message {
            padding: 10px;
            margin-top: 10px;
            border-radius: 4px;
        }
        .success {
            background-color: #dff0d8;
            color: #3c763d;
        }
        .error {
            background-color: #f2dede;
            color: #a94442;
        }
        .sentiment-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            margin-left: 5px;
            font-weight: bold;
        }
        .positive {
            background-color: #dff0d8;
            color: #3c763d;
        }
        .neutral {
            background-color: #d9edf7;
            color: #31708f;
        }
        .negative {
            background-color: #f2dede;
            color: #a94442;
        }
        .chatbot-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 350px;
            max-height: 500px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            z-index: 1000;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .chatbot-container.collapsed {
            height: 60px;
        }

        /* Chatbot Header */
        .chatbot-header {
            background-color: #4a6cf7;
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }

        .chatbot-title {
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chatbot-controls {
            display: flex;
            gap: 10px;
        }

        .chatbot-button {
            background: transparent;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 16px;
        }

        /* Chatbot Messages */
        .chatbot-messages {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-height: 300px;
        }

        .message {
            padding: 10px 15px;
            border-radius: 18px;
            max-width: 80%;
            word-wrap: break-word;
        }

        .user-message {
            background-color: #e6f7ff;
            align-self: flex-end;
            border-bottom-right-radius: 4px;
        }

        .bot-message {
            background-color: #f1f1f1;
            align-self: flex-start;
            border-bottom-left-radius: 4px;
        }

        /* Typing indicator */
        .typing-indicator {
            display: none;
            align-self: flex-start;
            background-color: #f1f1f1;
            padding: 8px 15px;
            border-radius: 18px;
            border-bottom-left-radius: 4px;
        }

        .typing-indicator span {
            height: 10px;
            width: 10px;
            margin: 0 1px;
            background-color: #9e9ea1;
            display: inline-block;
            border-radius: 50%;
            animation: bounce 1.2s infinite ease-in-out;
        }

        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes bounce {
            0%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
        }

        /* Input Area */
        .chatbot-input {
            display: flex;
            padding: 10px;
            border-top: 1px solid #eee;
        }

        #user-input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 20px;
            outline: none;
        }

        #send-button {
            background-color: #4a6cf7;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-left: 10px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Chatbot Toggle Button */
        .chat-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background-color: #4a6cf7;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            z-index: 999;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .chatbot-container {
                width: 90%;
                max-width: 350px;
                bottom: 10px;
                right: 10px;
            }
            
            .chat-toggle {
                bottom: 10px;
                right: 10px;
            }
        }

        /* Thêm style cho icon */
        .icon {
            margin-right: 8px;
        }
        
        .nav-icon {
            font-size: 1.2rem;
            margin-right: 5px;
        }
        
        .social-icon {
            font-size: 1.5rem;
            margin-right: 10px;
        }
        
        .footer-icon {
            margin-right: 10px;
            color: #4a6cf7;
        }
        
        .contact-info {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .contact-info i {
            width: 20px;
            margin-right: 10px;
            color: #4a6cf7;
        }
        
        .search-box {
            display: flex;
            align-items: center;
            background: #f1f1f1;
            border-radius: 20px;
            padding: 5px 15px;
            margin-left: 20px;
        }
        
        .search-box input {
            border: none;
            background: none;
            outline: none;
            padding: 5px;
            width: 200px;
        }
        
        .search-box i {
            color: #666;
        }
    </style>
</head>
<body>
    <header>
        <div class="header-container">
            <div class="logo">
                <i class="fas fa-store icon"></i>ShopOnline
            </div>
            <nav>
                <ul>
                    <li><a href="#"><i class="fas fa-home nav-icon"></i>Trang chủ</a></li>
                    <li><a href="#"><i class="fas fa-tshirt nav-icon"></i>Sản phẩm</a></li>
                    <li><a href="#"><i class="fas fa-percent nav-icon"></i>Khuyến mãi</a></li>
                    <li><a href="#"><i class="fas fa-info-circle nav-icon"></i>Giới thiệu</a></li>
                    <li><a href="#"><i class="fas fa-envelope nav-icon"></i>Liên hệ</a></li>
                </ul>
            </nav>
            <div class="header-right">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Tìm kiếm sản phẩm...">
                </div>
            </div>
        </div>
    </header>

    <div class="banner" style="background-image: linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url('https://images.unsplash.com/photo-1512436991641-6745cdb1723f?auto=format&fit=crop&w=1200&q=80'); background-size: cover; background-position: center;">
        <div class="banner-content">
            <h1>Bộ sưu tập mới nhất 2025</h1>
            <a href="#" class="btn">Khám phá ngay</a>
        </div>
    </div>

    <main>
        <h2 class="section-title">Sản phẩm nổi bật</h2>

        <div class="products">
            <!-- Sản phẩm 1 -->
            <div class="product-card">
                <div class="product-image">
                    <img src="/static/image/aothunnam.jpeg" alt="Sản phẩm 1">
                </div>
                <div class="product-info">
                    <h3 class="product-title">Áo thun nam basic</h3>
                    <div class="product-price">299.000đ</div>
                    <button class="add-to-cart">Thêm vào giỏ hàng</button>
                </div>
            </div>

            <!-- Sản phẩm 2 -->
            <div class="product-card">
                <div class="product-image">
                    <img src="/static/image/jean.jpeg" alt="Sản phẩm 2">
                </div>
                <div class="product-info">
                    <h3 class="product-title">Quần jean nam</h3>
                    <div class="product-price">459.000đ</div>
                    <button class="add-to-cart">Thêm vào giỏ hàng</button>
                </div>
            </div>

            <!-- Sản phẩm 3 -->
            <div class="product-card">
                <div class="product-image">
                    <img src="/static/image/somi_nam.jpeg" alt="Sản phẩm 3">
                </div>
                <div class="product-info">
                    <h3 class="product-title">Áo sơ mi kẻ sọc</h3>
                    <div class="product-price">359.000đ</div>
                    <button class="add-to-cart">Thêm vào giỏ hàng</button>
                </div>
            </div>

            <!-- Sản phẩm 4 -->
            <div class="product-card">
                <div class="product-image">
                    <img src="/static/image/aokhoac.jpeg" alt="Sản phẩm 4">
                </div>
                <div class="product-info">
                    <h3 class="product-title">Áo khoác nam</h3>
                    <div class="product-price">529.000đ</div>
                    <button class="add-to-cart">Thêm vào giỏ hàng</button>
                </div>
            </div>
        </div>
        <div class="review-form-container">
        <h3>Gửi đánh giá của bạn</h3>
        <form id="reviewForm">
            <div class="form-group">
                <label for="author">Tên của bạn</label>
                <input type="text" id="author" name="author" required>
            </div>
            <div class="form-group">
                <label for="reviewText">Nội dung đánh giá</label>
                <textarea id="reviewText" name="reviewText" rows="4" required></textarea>
            </div>
            <button type="submit" class="submit-review-btn">Gửi đánh giá</button>
        </form>
    </div>
    <div id="message"></div>
    <div class="chat-toggle" id="chat-toggle">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
            </svg>
        </div>

        <!-- Chatbot container -->
        <div class="chatbot-container" id="chatbot-container" style="display:none;">
            <div class="chatbot-header" id="chatbot-header">
                <div class="chatbot-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                    Tư vấn viên
                </div>
                <div class="chatbot-controls">
                    <button class="chatbot-button" id="minimize-button">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                    </button>
                    <button class="chatbot-button" id="close-button">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="chatbot-messages" id="chatbot-messages">
                <div class="message bot-message">
                    Xin chào! Tôi là trợ lý ảo hỗ trợ khách hàng. Tôi có thể giúp gì cho bạn hôm nay?
                </div>
            </div>
            <div class="typing-indicator" id="typing-indicator">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <div class="chatbot-input">
                <input type="text" id="user-input" placeholder="Nhập tin nhắn..." />
                <button id="send-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="22" y1="2" x2="11" y2="13"></line>
                        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                    </svg>
                </button>
            </div>
        </div>
    </main>
    <footer>
        <div class="footer-container">
            <div class="footer-section">
                <h3><i class="fas fa-store footer-icon"></i>Liên hệ ShopOnline</h3>
                <div class="contact-info">
                    <i class="fas fa-map-marker-alt"></i>
                    <p>Địa chỉ: 123 Đường Thời Trang, Quận 1, TP.HCM</p>
                </div>
                <div class="contact-info">
                    <i class="fas fa-phone"></i>
                    <p>Điện thoại: 0123 456 789</p>
                </div>
                <div class="contact-info">
                    <i class="fas fa-envelope"></i>
                    <p>Email: support@shoponline.vn</p>
                </div>
            </div>
            <div class="footer-section">
                <h3><i class="fas fa-share-alt footer-icon"></i>Kết nối với chúng tôi</h3>
                <div class="social-links">
                    <a href="#"><i class="fab fa-facebook social-icon"></i>Facebook</a>
                    <a href="#"><i class="fab fa-instagram social-icon"></i>Instagram</a>
                    <a href="#"><i class="fab fa-twitter social-icon"></i>Twitter</a>
                </div>
            </div>
        </div>
        <div class="copyright">
            <i class="fas fa-copyright"></i> 2025 ShopOnline. All rights reserved.
        </div>
    </footer>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f9f9f9;
        }

        header {
            background-color: #fff;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #4a6cf7;
        }

        nav ul {
            display: flex;
            list-style: none;
        }

        nav ul li {
            margin-left: 20px;
        }

        nav ul li a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s;
        }

        nav ul li a:hover {
            color: #4a6cf7;
        }

        .banner {
            background-image: linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url('https://images.unsplash.com/photo-1512436991641-6745cdb1723f?auto=format&fit=crop&w=1200&q=80');
            background-size: cover;
            background-position: center;
            height: 400px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
        }

        .banner-content h1 {
            font-size: 42px;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .btn {
            display: inline-block;
            padding: 12px 30px;
            background-color: #4a6cf7;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        .btn:hover {
            background-color: #3a5bd9;
        }

        main {
            max-width: 1200px;
            margin: 40px auto;
            padding: 0 20px;
        }

        .section-title {
            text-align: center;
            margin-bottom: 30px;
            color: #333;
        }

        .products {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .product-card {
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }

        .product-card:hover {
            transform: translateY(-5px);
        }

        .product-image {
            width: 100%;
            height: 200px;
            overflow: hidden;
        }

        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .product-info {
            padding: 15px;
        }

        .product-title {
            font-size: 18px;
            margin-bottom: 10px;
            color: #333;
        }

        .product-price {
            font-size: 20px;
            font-weight: bold;
            color: #4a6cf7;
            margin-bottom: 15px;
        }

        .add-to-cart {
            width: 100%;
            padding: 10px;
            background-color: #4a6cf7;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        .add-to-cart:hover {
            background-color: #3a5bd9;
        }

        footer {
            background-color: #333;
            color: white;
            padding: 40px 0 20px;
        }

        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }

        .footer-section h3 {
            margin-bottom: 20px;
            font-size: 20px;
        }

        .footer-section p {
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .social-links {
            display: flex;
            gap: 15px;
        }

        .social-links a {
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .copyright {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        @media (max-width: 768px) {
            .banner {
                height: 300px;
            }
            
            .banner-content h1 {
                font-size: 32px;
            }
        }
        .review-form-container {
            background-color: #f9f9f9;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .submit-review-btn {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        .submit-review-btn:hover {
            background-color: #45a049;
        }
        #message {
            padding: 10px;
            margin-top: 10px;
            border-radius: 4px;
        }
        .success {
            background-color: #dff0d8;
            color: #3c763d;
        }
        .error {
            background-color: #f2dede;
            color: #a94442;
        }
        .sentiment-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            margin-left: 5px;
            font-weight: bold;
        }
        .positive {
            background-color: #dff0d8;
            color: #3c763d;
        }
        .neutral {
            background-color: #d9edf7;
            color: #31708f;
        }
        .negative {
            background-color: #f2dede;
            color: #a94442;
        }
        .chatbot-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 350px;
            max-height: 500px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            z-index: 1000;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .chatbot-container.collapsed {
            height: 60px;
        }

        /* Chatbot Header */
        .chatbot-header {
            background-color: #4a6cf7;
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }

        .chatbot-title {
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chatbot-controls {
            display: flex;
            gap: 10px;
        }

        .chatbot-button {
            background: transparent;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 16px;
        }

        /* Chatbot Messages */
        .chatbot-messages {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-height: 300px;
        }

        .message {
            padding: 10px 15px;
            border-radius: 18px;
            max-width: 80%;
            word-wrap: break-word;
        }

        .user-message {
            background-color: #e6f7ff;
            align-self: flex-end;
            border-bottom-right-radius: 4px;
        }

        .bot-message {
            background-color: #f1f1f1;
            align-self: flex-start;
            border-bottom-left-radius: 4px;
        }

        /* Typing indicator */
        .typing-indicator {
            display: none;
            align-self: flex-start;
            background-color: #f1f1f1;
            padding: 8px 15px;
            border-radius: 18px;
            border-bottom-left-radius: 4px;
        }

        .typing-indicator span {
            height: 10px;
            width: 10px;
            margin: 0 1px;
            background-color: #9e9ea1;
            display: inline-block;
            border-radius: 50%;
            animation: bounce 1.2s infinite ease-in-out;
        }

        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes bounce {
            0%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
        }

        /* Input Area */
        .chatbot-input {
            display: flex;
            padding: 10px;
            border-top: 1px solid #eee;
        }

        #user-input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 20px;
            outline: none;
        }

        #send-button {
            background-color: #4a6cf7;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-left: 10px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Chatbot Toggle Button */
        .chat-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background-color: #4a6cf7;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            z-index: 999;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .chatbot-container {
                width: 90%;
                max-width: 350px;
                bottom: 10px;
                right: 10px;
            }
            
            .chat-toggle {
                bottom: 10px;
                right: 10px;
            }
        }
    </style>
</body>
<script>
  document.getElementById("reviewForm").addEventListener("submit", function(event) {
    event.preventDefault();

    const formData = new FormData(this);
    const messageDiv = document.getElementById("message");
    
    messageDiv.innerText = "Đang gửi đánh giá..."; 
    messageDiv.className = '';

    fetch('/submit_review', {
        method: 'POST',
        body: formData
    })
    .then(response => {
        if (!response.ok) {
            return response.json().then(data => {
                throw new Error(data.details || `HTTP error! Status: ${response.status}`);
            });
        }
        return response.json();
    })
    .then(data => {
        if (data.message) {
            messageDiv.innerText = data.message;
            messageDiv.className = 'success';
            
            if (data.sentiment) {
                let sentimentClass = '';
                if (data.sentiment === 'Tích cực') sentimentClass = 'positive';
                else if (data.sentiment === 'Trung lập') sentimentClass = 'neutral';
                else if (data.sentiment === 'Tiêu cực') sentimentClass = 'negative';
                
                const confText = data.confidence ? ` (độ tin cậy: ${data.confidence})` : '';
                messageDiv.innerHTML += ` Đánh giá của bạn được phân loại là: <span class="sentiment-badge ${sentimentClass}">${data.sentiment}${confText}</span>`;
            }
            
            document.getElementById("reviewForm").reset();
        } else {
            messageDiv.innerText = 'Đã xảy ra lỗi: ' + (data.details || '');
            messageDiv.className = 'error';
        }
    })
    .catch(error => {
        console.error("Error submitting review:", error);
        messageDiv.innerText = 'Đã xảy ra lỗi khi gửi đánh giá: ' + error.message;
        messageDiv.className = 'error';
    });
  });
    function initChatbot() {
    // Các phần tử DOM
    const chatToggle = document.getElementById('chat-toggle');
    const chatbotContainer = document.getElementById('chatbot-container');
    const chatbotHeader = document.getElementById('chatbot-header');
    const minimizeButton = document.getElementById('minimize-button');
    const closeButton = document.getElementById('close-button');
    const chatbotMessages = document.getElementById('chatbot-messages');
    const userInput = document.getElementById('user-input');
    const sendButton = document.getElementById('send-button');
    const typingIndicator = document.getElementById('typing-indicator');

    // Địa chỉ API Ollama
    const OLLAMA_API_URL = 'http://localhost:11434/api/generate';

    // Thêm prompt hướng dẫn
    const systemPrompt = `Bạn là nhân viên chăm sóc khách hàng của ShopOnline, luôn xưng "mình" và gọi khách là "bạn", "anh", "chị" tùy ngữ cảnh. Chỉ tư vấn các sản phẩm sau:
- Áo thun nam basic 299.000đ
- Quần jean nam 459.000đ
- Áo sơ mi kẻ sọc 359.000đ
- Áo khoác nam 529.000đ

Quy trình tư vấn:
1. Đầu tiên, hãy hỏi khách về nhu cầu, mục đích sử dụng, phong cách, v.v. để tư vấn chọn sản phẩm phù hợp nhất trong danh sách trên.
2. Sau khi khách đã chọn được sản phẩm, hãy hỏi tiếp các thông tin: cân nặng, chiều cao, sở thích màu sắc.
3. Khi khách đã chọn sản phẩm, hãy thông báo các màu sắc và size còn hàng của sản phẩm đó trong kho theo dữ liệu sau:

Tồn kho:
- Áo thun nam basic: Màu trắng (S, M, L), Màu đen (M, L, XL), Màu xanh (S, M)
- Quần jean nam: Màu xanh đậm (M, L, XL), Màu đen (S, M, L)
- Áo sơ mi kẻ sọc: Màu xanh nhạt (M, L), Màu trắng (S, M, L, XL)
- Áo khoác nam: Màu xám (L, XL), Màu đen (M, L, XL, XXL)

Chỉ thông báo màu sắc và size còn hàng sau khi khách đã chọn sản phẩm. Nếu khách chưa chọn sản phẩm, hãy tư vấn chọn sản phẩm trước.

Sau khi có đủ thông tin, hãy tư vấn size phù hợp dựa trên bảng size:
- Size S: 1m55-1m60, 45-53kg
- Size M: 1m60-1m68, 54-60kg
- Size L: 1m68-1m75, 61-70kg
- Size XL: 1m75-1m80, 71-80kg
- Size XXL: trên 1m80, trên 80kg

Nếu khách chưa trả lời đủ, hãy nhắc lại và hỏi tiếp cho đủ thông tin. Không tư vấn size hoặc sản phẩm cụ thể khi chưa đủ dữ liệu.
Luôn trả lời ngắn gọn, thân thiện, tự nhiên, không dùng từ ngữ máy móc, không nói về sản phẩm ngoài danh sách trên.
Nếu khách phàn nàn hãy xin lỗi lịch sự và hỏi khách có thể giúp gì thêm không? 
Nếu khách hỏi ngoài các vấn đề về sản phẩm, size, màu sắc, hoặc có thắc mắc/phàn nàn khác, hãy hướng dẫn khách truy cập 
Facebook của shop tại https://facebook.com/shoponline.vn để được tư vấn kỹ hơn.`;

    // Lưu lịch sử hội thoại
    let chatHistory = [];

    // Hiển thị/ẩn chatbot
    chatToggle.addEventListener('click', function() {
        chatbotContainer.style.display = 'flex';
        chatToggle.style.display = 'none';
        chatbotContainer.classList.remove('collapsed');
        chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
    });

    // Đóng chatbot
    closeButton.addEventListener('click', function() {
        chatbotContainer.style.display = 'none';
        chatToggle.style.display = 'flex';
        // Xóa lịch sử hội thoại khi đóng chat
        chatHistory = [];
    });

    // Thu nhỏ/mở rộng chatbot
    minimizeButton.addEventListener('click', function() {
        chatbotContainer.classList.toggle('collapsed');
    });

    // Mở rộng chatbot khi click vào header (nếu đang thu nhỏ)
    chatbotHeader.addEventListener('click', function() {
        if (chatbotContainer.classList.contains('collapsed')) {
            chatbotContainer.classList.remove('collapsed');
        }
    });

    // Gửi tin nhắn khi nhấn nút gửi
    sendButton.addEventListener('click', sendMessage);

    // Gửi tin nhắn khi nhấn Enter
    userInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            sendMessage();
        }
    });

    // Hàm gửi tin nhắn
    function sendMessage() {
        const message = userInput.value.trim();
        if (message === '') return;

        // Hiển thị tin nhắn người dùng
        addMessage(message, 'user');
        userInput.value = '';

        // Hiển thị đang gõ...
        typingIndicator.style.display = 'flex';

        // Gọi API Ollama
        callOllamaAPI(message);
    }

    // Thêm tin nhắn vào khung chat
    function addMessage(content, sender) {
        const messageDiv = document.createElement('div');
        messageDiv.classList.add('message');
        messageDiv.classList.add(sender === 'user' ? 'user-message' : 'bot-message');
        messageDiv.textContent = content;
        
        chatbotMessages.appendChild(messageDiv);
        chatbotMessages.scrollTop = chatbotMessages.scrollHeight;

        // Lưu vào lịch sử hội thoại
        chatHistory.push({ role: sender, content: content });
    }

    // Gọi API Ollama để tạo phản hồi
    async function callOllamaAPI(prompt) {
        try {
            // Tạo prompt lớn gồm systemPrompt + lịch sử hội thoại
            let historyText = chatHistory.map(msg => {
                return (msg.role === 'user' ? 'Khách hàng: ' : 'Nhân viên: ') + msg.content;
            }).join('\n');
            const fullPrompt = systemPrompt + '\n' + historyText + '\nKhách hàng: ' + prompt;
            console.log('Đang gửi yêu cầu đến Ollama:', fullPrompt);
            
            const response = await fetch(OLLAMA_API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    model: 'llama3.1:8b',  // Sử dụng tên mô hình đúng
                    prompt: fullPrompt,
                    stream: false
                })
            });
            
            console.log('Trạng thái phản hồi:', response.status);
            
            if (!response.ok) {
                const errorText = await response.text();
                console.error('API trả về lỗi:', errorText);
                throw new Error(`Lỗi API: ${response.status} ${response.statusText}`);
            }

            const data = await response.json();
            console.log('Dữ liệu phản hồi:', data);
            
            // Ẩn đang gõ...
            typingIndicator.style.display = 'none';
            
            // Hiển thị phản hồi từ bot
            if (data && data.response) {
                addMessage(data.response, 'bot');
            } else {
                addMessage('Không nhận được phản hồi hợp lệ từ AI.', 'bot');
            }
        } catch (error) {
            console.error('Lỗi khi gọi API Ollama:', error);
            
            // Ẩn đang gõ...
            typingIndicator.style.display = 'none';
            
            // Hiển thị thông báo lỗi
            addMessage(`Xin lỗi, có lỗi xảy ra khi kết nối đến dịch vụ: ${error.message}`, 'bot');
        }
    }
}

// Khởi tạo khi trang đã load xong
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initChatbot);
} else {
    initChatbot();
}
</script>
</html>